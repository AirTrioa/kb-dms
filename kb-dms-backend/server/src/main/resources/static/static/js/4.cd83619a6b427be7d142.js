webpackJsonp([4],{"+cKO":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"alpha",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"alphaNum",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"numeric",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"between",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"email",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"ipAddress",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"macAddress",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"maxLength",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"minLength",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"required",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"requiredIf",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"requiredUnless",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(e,"sameAs",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(e,"url",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(e,"or",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(e,"and",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(e,"not",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(e,"minValue",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(e,"maxValue",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(e,"integer",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(e,"decimal",{enumerable:!0,get:function(){return q.default}}),e.helpers=void 0;var i=C(r("FWhV")),n=C(r("PKmV")),s=C(r("hbkP")),o=C(r("3Ro/")),a=C(r("6rz0")),u=C(r("HSVw")),l=C(r("HM/u")),c=C(r("qHXR")),d=C(r("4ypF")),p=C(r("4oDf")),h=C(r("lEk1")),f=C(r("6+Xr")),_=C(r("L6Jx")),m=C(r("7J6f")),g=C(r("Y18q")),b=C(r("bXE/")),v=C(r("FP1U")),y=C(r("aYrh")),x=C(r("xJ3U")),w=C(r("eqrJ")),q=C(r("pO+f")),k=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}(r("URu4"));function C(t){return t&&t.__esModule?t:{default:t}}e.helpers=k},"1alW":function(t,e,r){var i=r("kM2E");i(i.S,"Number",{isInteger:r("AKgy")})},"3Ro/":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(t,e){return(0,i.withParams)({type:"between",min:t,max:e},function(r){return!(0,i.req)(r)||(!/\s/.test(r)||r instanceof Date)&&+t<=+r&&+e>=+r})}},"3ria":function(t,e,r){"use strict";var i=r("Gu7T"),n=r.n(i);e.a={data:function(){return{opened:!1,loading:!1,minWidth:"500px",maxWidth:"500px",noBackdropDismiss:!0}},methods:{title:function(t){return"title"},init:function(t){},submit:function(t){t.done,t.close},cancel:function(){},hide:function(){},render_contents:function(t){return[]},render_foot_left:function(t){},show:function(t){this.opened=!0;for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];this.__init.apply(this,[t].concat(n()(r)))},__hide:function(){this.loading=!1,this.hide()},__init:function(t){this.loading=!1;for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];this.init.apply(this,[t].concat(n()(r))),this.$v&&this.$v.model&&this.$v.model.$reset()},__submit:function(){var t=this,e=function(){return t.loading=!1},r=function(){return t.opened=!1};void 0!=this.$v?(this.$v&&this.$v.model&&this.$v.model.$touch(),this.$v.model.$error?this.$q.warning("请输入所有必填字段"):(this.loading=!0,this.submit({done:e,close:r}))):this.submit({done:e,close:r})},__render_close_icon:function(t){return t("q-icon",{staticClass:"absolute-top-right bg-white text-faded cursor-pointer pp-selectable-color-red",style:{borderRadius:"50%",transform:"translate(40%, -40%)",zIndex:"1",fontSize:"20px"},nativeOn:{click:this.cancel},props:{name:"cancel"},directives:[{name:"close-overlay"}]})},__render_modal_layout:function(t){return[this.__render_title(t),t("div",{staticClass:"full-width bg-grey-4",style:{height:"1px",flexShrink:0}}),this.__render_contents(t),this.__render_footer(t)]},__render_contents:function(t){return t("div",{staticClass:"col-grow",style:{padding:"16px 28px",margin:"0 4px",overflow:"auto"}},[this.render_contents(t)])},__render_title:function(t){return t("div",{staticClass:"font-14 text-weight-bold",style:{padding:"13px 15px"}},[this.title(t)])},__render_footer:function(t){return t("div",{staticClass:"row items-center justify-end",style:{height:"48px",minHeight:"48px",borderTop:"1px solid var(--q-color-grey-4)"}},[this.render_foot_left(t),t("div",{staticClass:"col-grow"}),t("q-btn",{staticClass:"q-pt-none q-pb-none q-mr-md shadow-0",style:{minHeight:"32px",height:"32px",fontSize:"12px",width:"75px"},props:{label:"确定",size:"md",color:"blue-6",loading:this.loading},on:{click:this.__submit}}),t("q-btn",{staticClass:"q-pt-none q-pb-none q-mr-md shadow-0",style:{minHeight:"32px",height:"32px",fontSize:"12px",width:"75px"},props:{label:"取消",flat:!0,size:"md",color:"faded"},on:{click:this.cancel},directives:[{name:"close-overlay"}]})])}},render:function(t){var e=this;return t("q-modal",{props:{contentCss:{minWidth:this.minWidth,maxWidth:this.maxWidth,minHeight:"200px",maxHeight:"90vh",border:"1px solid var(--q-color-faded)"},contentClasses:"column no-wrap",value:this.opened,noBackdropDismiss:this.noBackdropDismiss},on:{input:function(t){return e.opened=t},hide:this.__hide}},[this.__render_close_icon(t),this.__render_modal_layout(t)])}}},"4oDf":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4"),n=(0,i.withParams)({type:"required"},i.req);e.default=n},"4ypF":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(t){return(0,i.withParams)({type:"minLength",min:t},function(e){return!(0,i.req)(e)||(0,i.len)(e)>=t})}},"5zde":function(t,e,r){r("zQR9"),r("qyJz"),t.exports=r("FeBl").Array.from},"6+Xr":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(t){return(0,i.withParams)({type:"requiredUnless",prop:t},function(e,r){return!!(0,i.ref)(t,this,r)||(0,i.req)(e)})}},"6rz0":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=(0,r("URu4").regex)("email",/(^$|^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/);e.default=i},"7J6f":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=(0,r("URu4").regex)("url",/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);e.default=i},AKgy:function(t,e,r){var i=r("EqjI"),n=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&n(t)===t}},FP1U:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(t){return(0,i.withParams)({type:"not"},function(e,r){return!(0,i.req)(e)||!t.call(this,e,r)})}},FWhV:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=(0,r("URu4").regex)("alpha",/^[a-zA-Z]*$/);e.default=i},Fi8O:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("fZjL"),n=r.n(i),s=r("Kkag");function o(t,e,r){var i={kw:t,status:e,type:r};return Object(s.a)({url:"/api/bus/group/_search",method:"get",params:i})}function a(t,e,r){var i={name:e,status:r};return Object(s.a)({url:"/api/bus/group/"+t,method:"patch",data:i})}var u=r("C7S3"),l=r("5+05"),c=r("mvHQ"),d=r.n(c),p=r("Dd8w"),h=r.n(p);function f(t){if(t===window)return{top:0,left:0};var e=t.getBoundingClientRect();return{top:e.top,left:e.left}}var _={name:"pp-navigator",props:{options:Array,value:[Object,String,Number],distinct_key:String,disable:Boolean},data:function(){return{pointer_pos:0}},mounted:function(){var t=this;this.value&&this.$nextTick(function(){return t.select(t.value)})},render:function(t){var e=this;return t("div",{staticClass:"flex no-wrap relative-position items-center",style:{minHeight:"35px",borderBottom:"1px solid var(--q-color-grey-4)"}},[this.$slots.start,(this.options||[]).map(function(r){return e.render_item(t,r)}),this.$slots.after,t("div",{staticClass:"col-grow"}),this.$slots.end,this.disable?null:this.render_triangle(t)])},methods:{render_item:function(t,e){var r=this,i=this.same(e),n=this.disable?{class:"cursor-not-allowed",style:{opacity:.4}}:i?{class:"text-primary "}:{class:"text-grey-5 pp-selectable-color-blue-4 cursor-pointer",on:{click:function(){return r.select(e)}}};return t("div",h()({staticClass:"font-13 text-weight-bold q-ml-sm q-mr-sm non-selectable"},n,{ref:this.get_key(e)}),[this.$scopedSlots.item?this.$scopedSlots.item(e,i):e])},render_triangle:function(t){return this.pointer_pos?t("div",{staticClass:"pp-arrow-up absolute",style:{left:this.pointer_pos+"px",bottom:0,transition:"left 0.2s"}}):null},get_key:function(t){return this.distinct_key?t[this.distinct_key]:d()(t)},same:function(t){return this.value&&this.get_key(this.value)===this.get_key(t)},select:function(t){var e=this.$refs[this.get_key(t)];this.pointer_pos=f(e).left-f(this.$el).left+parseInt(function(t,e){return window.getComputedStyle(t).getPropertyValue(e)}(e,"width"))/2-7,this.$emit("select",t)}}},m={all:"所有",created_by_me:"我创建的",owner_by_me:"我负责的"},g={name:"comp_group_catalog",data:function(){return{groups:[],group:null,page:1,size:50,no_more_group:!1,query_type:"all",kw:null}},watch:{query_type:{immediate:!0,handler:function(t,e){t&&this.refresh_catalog()}}},methods:{render_search:function(t){var e=this;return t(u.a,{staticClass:"pp-search-input",style:{margin:"3px"},props:{value:this.kw,placeholder:"按名称查找",width:"100%"},on:{input:function(t){e.kw=t,e.$nextTick(e.refresh_catalog)}}})},render_group_catalog_item:function(t,e){var r=this;return t("div",{staticClass:"pp-selectable-bg q-pl-sm q-pr-sm flex no-wrap justify-between cursor-pointer text-left",class:{"pp-selected-bg":this.group&&this.group.id===e.id},style:{lineHeight:"36px",width:"300px"},on:{click:function(){return r.select_group(e)}},key:e.id},[t("div",{staticClass:"ellipsis"},e.name),t("div",{style:{width:"50px"}},[l.a[e.status].label])])},refresh_catalog:function(){var t=this;this.groups=[],o(this.kw,null,this.query_type).then(function(e){t.no_more_group=!e.data||0===e.data.length||e.data.length<t.size,t.groups=t.groups.concat(e.data||[]),!t.group&&t.groups.length>0&&t.select_group(t.groups[0])}).catch(function(){return t.$q.err("获取业务团队列表异常")})},select_group:function(t){this.group=t,this.$emit("input",t)}},render:function(t){var e=this;return t("transition",{props:{appear:!0,mode:"out-in",enterActiveClass:"animate-popup-down"}},[t("div",{staticClass:"font-13 text-dark scroll",style:{width:"300px",minWidth:"300px"}},[t(_,{props:{value:this.query_type,options:n()(m)},scopedSlots:{item:function(t){return m[t]}},on:{select:function(t){e.query_type=t}}}),this.render_search(t),this.groups.map(function(r){return[e.render_group_catalog_item(t,r),t("q-item-separator",{staticClass:"q-ma-none"})]})])])}},b=(r("Xd8P"),{name:"ppSection",props:{value:{type:Boolean,default:null},label:String,collapse:{type:Boolean,default:!1},fakeValue:{type:Boolean,default:!0}},data:function(){return{}},methods:{render_head:function(t){return t("div",{staticClass:"flex items-center no-wrap"},[this.label?t("span",{staticClass:"text-weight-bold q-pr-sm"},this.label):null,this.$slots.label,this.$slots.before,t("div",{staticClass:"col-grow",style:{background:this.collapse?"linear-gradient(to right, var(--q-color-grey-4), var(--q-color-blue-2))":"var(--q-color-grey-4)",minHeight:"1px",height:"1px"}}),this.$slots.after,this.collapse?this.render_collapse_btn(t):null])},render_collapse_btn:function(t){return t("div",{staticClass:"relative-position",style:{width:"20px",height:"18px"}},[t("q-icon",{staticClass:"text-primary pp-selectable-color-blue-4 cursor-pointer absolute-right icon-toggle",class:{"active-toggle":this.fakeValue,"inactive-toggle":!this.fakeValue},style:{fontSize:"18px"},props:{name:"indeterminate_check_box"},nativeOn:{click:this.click}}),t("q-icon",{staticClass:"text-primary pp-selectable-color-blue-4 cursor-pointer absolute-right icon-toggle",class:{"active-toggle":!this.fakeValue,"inactive-toggle":this.fakeValue},style:{fontSize:"18px"},props:{name:"add_box"},nativeOn:{click:this.click}})])},render_content:function(t){return t("div",{staticClass:"q-mt-sm"},[this.$slots.default])},click:function(){this.fakeValue=!this.fakeValue,this.$emit("input",this.fakeValue)}},render:function(t){return null!==this.value&&(this.fakeValue=this.value),t("div",{},[this.render_head(t),this.fakeValue?this.render_content(t):null])}}),v=r("1FZX"),y=r("Gu7T"),x=r.n(y),w=r("bOdI"),q=r.n(w),k=r("fa+n"),C=r("uoZE"),$=r("obBT"),S=function t(e){this.value=e,this.ofNullable=function(e){return new t(e)},this.map=function(t){return this.value&&(this.value=t(this.value)),this},this.orElse=function(t){return this.value?this.value:"function"==typeof t?t():t},this.ifPresent=function(t){this.value&&t(this.value)}};S.ofNullable=function(t){return new S(t)};r("GsBR");var O={props:{value:[Number,String,Object,Array],disable:Boolean,clear:Boolean}},j=(Object,Object,Object,String,String,String,String,Number,String,Array,Array,{name:"GenericFormUIStrInput",mixins:[O],props:{type:{type:String,default:"text",validator:function(t){return["text","textarea"].includes(t)}},key_map:String,placeholder:{default:"待输入"},active_class_list:Array,retire_class_list:Array,output_mode:{type:String,default:"sync",validator:function(t){return["sync","lazy","enter"].includes(t)}},before:{type:Array,default:function(){return[]}},after:{type:Array,default:function(){return[]}},minWidth:String},data:function(){return{keep_value:"",lazy_timer:null}},watch:{value:function(t){this.keep_value=t}},mounted:function(){this.keep_value=this.value},activated:function(){this.keep_value=this.value},computed:{fake_value:function(){return this.key_map?(this.value||{})[this.key_map]||"":this.value||""},enter_mode:function(){return"enter"===this.output_mode}},methods:{input:function(t){var e=this;this.keep_value=t,"sync"===this.output_mode?this.emit():"lazy"===this.output_mode&&(this.lazy_timer&&clearTimeout(this.lazy_timer),this.lazy_timer=setTimeout(function(){e.lazy_timer=null,e.emit()},200))},emit:function(){this.$emit("input",this.key_map?q()({},this.key_map,this.keep_value):this.keep_value)},focus:function(){this.$refs.input&&this.$refs.input.focus()}},render:function(t){var e=this,r=this.clear&&this.keep_value?[{icon:"cancel",handler:function(){e.keep_value=null,e.emit(),e.$refs.input.clear()}}]:[],i=this.enter_mode?[{icon:"keyboard_return",handler:this.emit}]:[];return t("q-input",{style:{minWidth:this.minWidth},props:{color:"primary",type:this.type,value:this.fake_value,placeholder:this.placeholder,hideUnderline:!0,disable:this.disable,clearable:!1,maxHeight:150,before:this.before,after:[].concat(r,i,x()(this.after))},ref:"input",on:{input:this.input,focus:function(t){e.retire_class_list&&e.$nextTick(function(){var t;return(t=e.$refs.input.$el.classList).remove.apply(t,x()(e.retire_class_list))}),e.active_class_list&&e.$nextTick(function(){var t;return(t=e.$refs.input.$el.classList).add.apply(t,x()(e.active_class_list))}),e.$emit("focus",t)},blur:function(t){e.active_class_list&&e.$nextTick(function(){var t;return(t=e.$refs.input.$el.classList).remove.apply(t,x()(e.active_class_list))}),e.retire_class_list&&e.$nextTick(function(){var t;return(t=e.$refs.input.$el.classList).add.apply(t,x()(e.retire_class_list))}),e.$emit("blur",t)},keyup:function(t){e.enter_mode&&"Enter"===t.key&&(e.emit(),e.$refs.input.blur()),e.$emit("keyup",t)}}},[this.$scopedSlots.default?this.$scopedSlots.default(this.fake_value,t):null])}}),P=(Array,Array,Array,Boolean,{name:"GenericFormUIUserSelector",mixins:[O],props:{placeholder:{default:"待选择"},multiple:{type:Boolean,default:!0},confirm:Boolean,key_map:{type:String,default:"account"},label_map:{type:String,default:"name"},key_trans:{type:String,default:"account"},label_trans:{type:String,default:"name"},retire_class_list:Array,active_class_list:Array,popup_offset:Array,popup_from_top:Boolean,include_group:Boolean,filter_out_account:Array,auto_hide:{type:Boolean,default:!0}},data:function(){return{user_list:[],kw:""}},computed:{filter_user_list:function(){var t=this,e=this.user_list;return e=this.filter_out_account&&this.filter_out_account.length?e.filter(function(e){return!t.filter_out_account.includes(e.account)}):e}},methods:{request_user:function(){var t=this;this.kw&&Object(C.b)(this.kw).then(function(e){return t.user_list=e.data}).catch(function(){return t.$q.err("查找用户异常")}),this.kw||(this.user_list=Object($.a)(5))}},render:function(t){var e=this;return t(z,{props:{value:this.value,disable:this.disable,clear:this.clear,placeholder:this.placeholder,multiple:this.multiple,confirm:this.confirm,static_options:this.filter_user_list,key_map:this.key_map,label_map:this.label_map,key_trans:this.key_trans,label_trans:this.label_trans,retire_class_list:this.retire_class_list,active_class_list:this.active_class_list,popup_offset:this.popup_offset,popup_from_top:this.popup_from_top,auto_hide:this.auto_hide,select_all:!1},on:{show:function(){e.kw=null,e.$refs.input.focus(),e.request_user()},input:function(t){e.$emit("input",t),Object($.b)(t)}},scopedSlots:h()({},this.$scopedSlots,{list_top:function(){return t(j,{staticClass:"q-ma-xs bg-white",props:{value:e.kw,placeholder:"通过关键字查找",output_mode:"lazy",before:[{icon:"search"}]},on:{input:function(t){e.kw=t,e.request_user()},focus:function(t){e.kw="",e.request_user()}},ref:"input"})},option:function(e){return t("div",{staticClass:"flex no-wrap items-center q-px-xs"},[t("i",{staticClass:"material-icons text-faded pp-radius font-16 q-mr-xs"},"person"),t("div",e.name),t("div",{staticClass:"q-ml-xs"},e.account)])}})})}}),z={name:"GenericFormUIGenericSelector",mixins:[O],props:{placeholder:{default:"待选择"},multiple:Boolean,confirm:Boolean,filter:Boolean,static_options:Array,grouping_func:Function,grouping_by:String,grouping_key:String,key_map:String,label_map:String,key_trans:String,label_trans:String,query:Object,query_func:Function,query_response_trans_func:Function,query_err_msg:{type:String,default:"查询异常"},active_class_list:Array,retire_class_list:Array,popup_offset:{type:Array,default:function(){return[0,1]}},popup_from_top:Boolean,maxHeight:{type:String,default:"350px"},anchor:String,self:String,auto_hide:{type:Boolean,default:!0},select_all:{type:Boolean,default:!0}},data:function(){return{query_options:[],filter_kw:"",active:!1}},computed:{fake_value:function(){return(this.value?JSON.parse(d()(this.value)):this.value)||[]},fake_options:function(){var t=this,e=(this.static_options?this.static_options:this.query_options)||[];return!Array.isArray(e)&&(e=this.query_options.data),e=e.map(function(e){return t.key_trans&&t.key_trans!==t.key_map&&(e[t.key_map]=e[t.key_trans]),t.label_trans&&t.label_trans!==t.label_map&&(e[t.label_map]=e[t.label_trans]),e}),this.filter&&this.filter_kw&&(e=e.filter(function(e){return e[t.label_map].includes(t.filter_kw)})),e},grouping:function(){return this.grouping_by||this.grouping_func},grouped_fake_options:function(){var t=this,e={};return this.grouping&&this.fake_options.forEach(function(r){var i=t.grouping_by?r[t.grouping_by]:t.grouping_func?t.grouping_func(r):null;i=i||(t.grouping_key?q()({},t.grouping_key,"no_group"):"no_group");var n=t.grouping_key?i[t.grouping_key]:i,s=e[n]||{by:i,options:[]};s.options.push(r),e[n]=s}),e},is_empty:function(){return!this.value||this.value instanceof Array&&0===this.value.length}},methods:{_render_field_content:function(t,e){return this.$scopedSlots.field_content?this.$scopedSlots.field_content(e,t):this.is_empty?this._render_field_placeholder(t):this.multiple?this._render_field_mu(t,e):this._render_field(t,e)},_render_field_mu:function(t,e){var r=this;return t("div",{staticClass:"flex"},(e=e||[]).map(function(i){return t("div",{staticClass:"flex no-wrap items-center"},[t("q-checkbox",{staticClass:"no-ripple",props:{value:!0},on:{input:function(){return r._select(e.filter(function(t){return!r._is_same(t,i)}))}}}),r._render_field(t,i)])}))},_render_field:function(t,e){return this.$scopedSlots.field?this.$scopedSlots.field(e,t):this.render_field(t,e)},render_field:function(t,e){return t("div",{staticClass:"pp-sentence"},[this.label_map?e[this.label_map]:e])},_render_field_placeholder:function(t){return t("div",{staticClass:"text-placeholder"},this.placeholder)},_render_field_prefix:function(t,e){return this.$scopedSlots.field_prefix?this.$scopedSlots.field_prefix(e):this.render_field_prefix(t,e)},render_field_prefix:function(t,e){},_render_field_suffix:function(t,e){return this.$scopedSlots.field_suffix?this.$scopedSlots.field_suffix(e):null},_render_field_clear:function(t,e){var r=this;return t("pp-clear",{props:{size:"xs",hide:!this.clear||this.multiple||this.is_empty,disable:this.disable},on:{click:function(t){t.stopPropagation(),r._select(null)}}})},_render_field_end:function(t,e){return this.$scopedSlots.field_end?this.$scopedSlots.field_end(e):null},_render_grouped_list:function(t){var e=this,r=this.grouped_fake_options,i=n()(r);return i.length?i.map(function(i){var n=r[i];return e._render_grouped_sections(t,n)}):this._render_no_options(t)},_render_grouped_sections:function(t,e){var r=this;if(this.$scopedSlots.group_section)return this.$scopedSlots.group_section(e);var i=null;if(this.multiple&&this.select_all){var n=this.fake_value.map(function(t){return r.key_map?t[r.key_map]:t}),s=e.options.filter(function(t){return!n.includes(r.key_map?t[r.key_map]:t)});i=t("q-checkbox",{staticClass:"no-ripple bg-grey-3 full-width pp-selectable-bg",style:{minHeight:"20px",lineHeight:"20px"},props:{value:!s.length||s.length!==e.options.length&&null},on:{input:function(t){t?s.forEach(function(t){return r.fake_value.push(t)}):e.options.map(function(t){return r.key_map?t[r.key_map]:t}).forEach(function(t){var e=n.indexOf(t);r.fake_value.splice(e,1),n.splice(e,1)}),r.confirm?r.$forceUpdate():r._select(r.fake_value)}}},[this.$scopedSlots.group_by?this.$scopedSlots.group_by(e.by,t):t("div",e.by)])}else i=this.$scopedSlots.group_by?this.$scopedSlots.group_by(e.by,t):t("div",{staticClass:"text-bold"},e.by);return[i,this._render_list(t,e.options)]},_render_list:function(t,e){return this.$scopedSlots.list?this.$scopedSlots.list(e,t):e.length?this.multiple?this._render_list_content_mu(t,e):this._render_list_content_sg(t,e):this._render_no_options(t)},_render_no_options:function(t){return t("span",{staticClass:"text-faded q-ml-xs q-mr-xs"},"无数据")},_render_list_content_mu:function(t,e){var r=this,i=e.disable,n=null;if(this.select_all&&!this.grouping){var s=!!this.fake_value.length&&(this.fake_value.length===e.length||null);n=[t("q-checkbox",{staticClass:"no-ripple pp-selectable-bg text-bold",style:{minHeight:"20px",lineHeight:"20px"},props:{value:s},on:{input:function(t){r.fake_value.splice(0,r.fake_value.length),t&&e.forEach(function(t){return r.fake_value.push(t)}),r.confirm?r.$forceUpdate():r._select(r.fake_value)}}},[t("div",{staticClass:"q-px-xs"},"全部选择")]),t("div",{staticClass:"bg-grey-3 q-my-xs",style:{height:"1px",flexShrink:0}})]}return t("div",{staticClass:"q-pt-xs q-pb-xs column no-wrap"},[n,e.map(function(e){return t("q-checkbox",{staticClass:"no-ripple q-pr-xs pp-selectable-bg",style:{minHeight:"20px",lineHeight:"20px"},props:{value:r._index_of(r.fake_value,e)>=0,disable:i},on:{input:function(t){t?r.fake_value.push(e):r.fake_value.splice(r._index_of(r.fake_value,e),1),r.confirm?r.$forceUpdate():r._select(r.fake_value)}}},[r._render_list_option(t,e)])})])},_render_list_content_sg:function(t,e){var r=this;return t("div",{staticClass:"q-pt-xs q-pb-xs column no-wrap"},e.map(function(e){var i=e.disable,n=r._is_same(r.fake_value,e)?{staticClass:"pp-selected-bg"}:i?{staticClass:"cursor-not-allowed text-light"}:{staticClass:"cursor-pointer pp-selectable-bg",on:{click:function(){r._select(e),r.auto_hide&&r.$refs.popup.hide()}}};return t("div",h()({},n,{style:{minHeight:"20px",lineHeight:"20px"}}),[r._render_list_option(t,e,i)])}))},_render_list_option:function(t,e){return this.$scopedSlots.option?this.$scopedSlots.option(e,t):this.render_list_option(t,e)},render_list_option:function(t,e){return t("div",{staticClass:"q-pl-xs q-pr-xs ellipsis",style:{minWidth:"60px"}},[this.label_map?e[this.label_map]:e])},_render_list_top:function(t,e){return this.$scopedSlots.list_top?this.$scopedSlots.list_top(e,t):this.render_list_top(t,e)},render_list_top:function(t,e){var r=this;if(this.filter)return t(j,{staticClass:"q-ma-xs bg-white",style:{flexShrink:0},props:{value:this.filter_kw,placeholder:"通过关键字查找",before:[{icon:"filter_list"}]},on:{input:function(t){return r.filter_kw=t},focus:function(t){return r.filter_kw=""}},ref:"input"})},_render_list_bottom:function(t,e){return this.$scopedSlots.list_bottom?this.$scopedSlots.list_bottom(e,t):this.render_list_bottom(t,e)},render_list_bottom:function(t,e){},_render_list_confirm:function(t,e){var r=this;if(this.confirm&&this.multiple&&e.length>0)return t("div",{staticClass:"font-13 non-selectable text-white text-weight-medium bg-blue-6 full-width text-center cursor-pointer pp-selectable-bg-blue-4",style:{height:"19px",lineHeight:"19px",borderTop:"1px solid var(--q-color-grey-4)"},on:{click:function(){r._select(r.fake_value||{}),r.$refs.popup.hide()}}},"确定")},_is_same:function(t,e){if(t&&e){if(!this.key_map)return t===e;if(t[this.key_map]&&e[this.key_map])return t[this.key_map].toString()===e[this.key_map].toString()}return!1},_index_of:function(t,e){var r=this;return this.key_map?t.map(function(t){return t[r.key_map]}).indexOf(e[this.key_map]):t.indexOf(e)},_select:function(t){this.$emit("input",t)},_show:function(){this.filter_kw="",this.request(),this.show(),this.$emit("show"),this.$refs.input&&this.$refs.input.focus()},request:function(){var t=this,e=void 0;this.query&&this.query.url&&(e=s.a.request(this.query)),this.query_func&&(e=this.query_func()),e&&e.then(function(e){return t.query_options=t.query_response_trans_func?t.query_response_trans_func(e):e}).catch(function(){return t.$q.err(t.err_msg)})},show:function(){},_hide:function(){this.hide(),this.$emit("hide")},hide:function(){}},render:function(t){var e=this;return t("div",{staticClass:"pjm-selector flex items-center no-wrap",class:{active:this.active,"cursor-not-allowed":this.disable,"cursor-pointer":!this.disable},style:{minWidth:0}},[this._render_field_prefix(t,this.value),this._render_field_content(t,this.value),this._render_field_suffix(t,this.value),t("div",{staticClass:"col-grow"}),this._render_field_clear(t,this.value),this._render_field_end(t,this.value),t(k.a,{staticClass:"pjm-selector-popover column no-wrap",style:{overflow:"hidden"},ref:"popup",props:{value:this.active,fit:!0,disable:this.disable,offset:this.popup_offset,active_class_list:this.active_class_list,retire_class_list:this.retire_class_list,anchor:this.anchor?this.anchor:this.popup_from_top?"top left":"bottom left",self:this.self?this.self:(this.popup_from_top,"top left"),maxHeight:this.maxHeight},on:{show:this._show,hide:this._hide,input:function(t){return e.active=t}}},[this._render_list_top(t,this.fake_options),t("div",{staticClass:"col-grow  scroll"},[this.grouping?this._render_grouped_list(t):this._render_list(t,this.fake_options)]),this._render_list_bottom(t,this.fake_options),this._render_list_confirm(t,this.fake_options)])])}},A=(String,Number,Date,String,Number,Date,Function,String,Boolean,Boolean,Boolean,Array,Array,Array,Boolean,String,Number,Date,String,Number,Date,Array,Array,Array,Boolean,{primary:"bg-blue-1",secondary:"bg-teal-1",faded:"bg-grey-3",light:"bg-grey-2",negative:"bg-red-1",warning:"bg-amber-1"}),B={name:"genericButton",props:{loading:Boolean,disable:Boolean,label:[Number,String],noCaps:Boolean,icon:String,iconRight:String,size:String,color:{type:String,default:"primary",validator:function(t){return["primary","secondary","faded","light","negative","warning"].includes(t)}},textColor:String,dense:Boolean,noRipple:Boolean,tabindex:Number,tooltip:{type:String,default:null}},render:function(t){return this.render_(t)},methods:{render_:function(t){return t("q-btn",{staticClass:"pp-border-"+this.color+" "+A[this.color]+" font-13",class:q()({}," pp-selectable-color-white pp-selectable-bg-"+this.color,!this.disable),style:{paddingTop:0,paddingBottom:0},props:h()({},this.$props,{flat:!0,noWrap:!0}),on:this._events},[this.tooltip&&t("q-tooltip",{props:{offset:[5,5]}},this.tooltip),this.$slots.default])}}},H={xs:{fontSize:"12px",minWidth:"14px",height:"14px",width:"14px"},sm:{fontSize:"15px",minWidth:"17px",height:"17px",width:"17px"},md:{fontSize:"18px",minWidth:"20px",height:"20px",width:"20px"},lg:{fontSize:"20px",minWidth:"22px",height:"22px",width:"22px"},xl:{fontSize:"24px",minWidth:"26px",height:"26px",width:"26px"}},W={primary:"pp-selectable-bg-blue-5",secondary:"pp-selectable-bg-teal",faded:"pp-selectable-bg-grey-5",light:"bg-grey-2",negative:"bg-red-1",warning:"bg-amber-1"},U={name:"iconButtonImprove",props:{value:Boolean,disable:Boolean,size:{type:String,required:!1,default:"md"},color:{type:String,default:"primary",validator:function(t){return["primary","secondary","faded","light","negative","warning"].includes(t)}},tooltip:String,round:Boolean},render:function(t){var e=this,r=void 0;return r=this.disable?{class:"cursor-not-allowed text-light"}:this.value?{class:"cursor-pointer text-white bg-"+this.color,on:{click:function(t){e.$emit("input",!1),e.$emit("click",t)}}}:this.round?{class:"cursor-pointer text-white bg-"+this.color+" pp-selectable-opacity-5",on:{click:function(t){e.$emit("input",!1),e.$emit("click",t)}}}:{class:"cursor-pointer text-"+this.color+" "+W[this.color]+" pp-selectable-color-white",on:{click:function(t){e.$emit("input",!0),e.$emit("click",t)}}},t("i",h()({staticClass:"material-icons non-selectable q-icon "+(this.round?"pp-radius-round":"pp-radius"),style:h()({padding:"1px"},H[this.size],{transition:"all 0.15s"})},r),[this.$slots.default,this.tooltip?t("q-tooltip",{props:{offset:[0,5]}},this.tooltip):null])}};var M={name:"comp_group_users",props:{disable:Boolean},data:function(){return{steps:[{id:1,name:"STEP1"}],edit_mode:!1,users:[],bus_group_id:null}},computed:{c_members:function(){var t={};return this.users.forEach(function(e){if(e.account){var r=e.account[0],i=t[r]||[];i.push(e),t[r]=i}}),t}},methods:{render_group_member_catalog:function(t){var e=this,r=n()(this.c_members);return t("div",{staticClass:"column no-wrap q-py-sm"},r.length?r.map(function(r){return t("div",{staticClass:"flex items-start no-wrap q-mb-md"},[t("div",{staticClass:"font-18 text-faded",style:{height:"26px",lineHeight:"26px",width:"30px",flexShrink:0}},r.toUpperCase()),e.render_group_members(t,e.c_members[r])])}):[t("div",{staticClass:"text-light"},"无数据")])},render_group_members:function(t,e){var r=this;return t("div",{staticClass:"flex"},e.map(function(e){return r.render_group_member_item(t,e)}))},render_group_member_item:function(t,e){var r=this;return t("div",{staticClass:"flex no-wrap items-center justify-between pp-border pp-radius bg-grey-2 q-px-xs q-mr-md q-mb-xs",style:{height:"26px",lineHeight:"26px",width:"165px",flexShrink:0}},[t("div",{staticClass:"text-tertiary text-weight-medium ellipsis"},e.name+"（"+e.account+"）"),this.disable?null:t("q-icon",{staticClass:"font-16 cursor-pointer text-grey-4 pp-selectable-color-faded",props:{name:"cancel"},nativeOn:{click:function(){return r.remove_user(e)}}})])},remove_user:function(t){var e,r,i,n=this;t&&t.account&&(e=this.bus_group_id,r=t.account,i={bus_group_id:e,account:r},Object(s.a)({url:"/api/bus/group/users/_delete",method:"delete",params:i})).then(this.refresh).catch(function(){return n.$q.err("删除失败")})},query:function(t){this.bus_group_id=t,this.refresh()},refresh:function(){var t,e,r=this;(t=this.bus_group_id,e={id:t},Object(s.a)({url:"/api/bus/group/users/_search",method:"get",params:e})).then(function(t){return r.users=t.data||[]}).catch(function(){return r.$q.err("查询人员列表异常")})}},render:function(t){var e=this;return t(b,{staticClass:"q-mb-md",props:{label:"人员管理",collapse:!1}},[this.render_group_member_catalog(t),this.disable?null:t(P,{staticClass:"no-border no-padding",props:{multiple:!1,filter_out_account:this.users.map(function(t){return t.account}),auto_hide:!1,disable:this.disable},on:{input:function(t){var r,i,n,o;(r=e.bus_group_id,i=t.name,n=t.account,o={name:i,bus_group_id:r,account:n},Object(s.a)({url:"/api/bus/group/users",method:"post",data:o})).then(function(t){1===t.status?e.refresh():e.$q.err(t.message)})}},scopedSlots:{field_content:function(t,e){return e(U,{props:{tooltip:"添加人员"}},"add")}},slot:"before"})])}},R=r("oc7c");var T=r("PHay"),D={name:"comp_group_detail",data:function(){return{group:{},owners:[],update_permission:!1}},methods:{render_base_info:function(t){var e=this;return t(b,{staticClass:"q-mb-md"},[t("div",{slot:"label",staticClass:"q-mr-xs text-weight-bold"},["基础信息"]),t("div",{staticClass:"row no-wrap"},[t("div",{staticClass:"col-12"},[this.render_tr(t,"名称：",t("q-input",{props:{placeholder:"请输入团队",value:this.group.name,hideUnderline:!0,disable:!this.update_permission,after:[{icon:"keyboard_return",handler:function(){a(e.group.id,e.group.name).then(function(t){1===t.status?(e.$emit("update"),e.$q.ok("修改成功!")):e.$q.err(t.message)})}}]},on:{input:function(t){return e.group.name=t}}})),this.render_tr(t,"负责人：",t(R.a,{props:{value:this.owners,placeholder:"请选择负责人",disable:!this.update_permission},on:{input:function(t){var r,i;e.owners=t,(r=e.group.id,i=e.owners,Object(s.a)({url:"/api/bus/group/"+r+"/owners",method:"patch",data:i})).then().catch()}}})),this.render_tr(t,"创建人：",this.group.creator_name),this.render_tr(t,"创建时间：",Object(v.a)(this.group.create_time,"YYYY-MM-DD HH:mm:ss")),this.render_tr(t,"激活：",t("q-toggle",{staticClass:"text-left",props:{leftLabel:!0,value:1===this.group.status,color:"deep-orange",disable:!this.update_permission},on:{input:function(t){e.group.status=!0===t?1:-1,a(e.group.id,null,e.group.status).then(function(r){1===r.status&&(!0===t?e.$q.ok("已激活！"):e.$q.ok("已失效！"))})}}}))])])])},render_tr:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"q-pa-xs text-tertiary";return t("tr",{staticClass:"text-left"},[t("td",{staticClass:"q-pa-xs",style:{textAlign:"left",whiteSpace:"nowrap"}},e),t("td",{staticClass:i},r?[r]:"--")])},select_group:function(t){t&&t.id&&(this.query_group(t.id),this.$refs.GroupUsers.query(t.id))},query_group:function(t){var e=this;Object(T.c)(t).then(function(t){1===t.status&&(e.update_permission=t.data)}).then(function(){var r,i;(r=t,Object(s.a)({url:"/api/bus/group/"+r,method:"get"})).then(function(t){return e.group=t.data||{}}).catch(function(){return e.$q.err("获取业务团队异常")}),(i=t,Object(s.a)({url:"/api/bus/group/"+i+"/owners",method:"get"})).then(function(t){e.owners=t.data||[]}).catch()})}},render:function(t){return t("transition",{props:{appear:!0,mode:"out-in",enterActiveClass:"animate-popup-down"}},[t("div",{staticClass:"scroll",style:{paddingLeft:"10px",paddingTop:"3px"}},[this.render_base_info(t),t(M,{ref:"GroupUsers",props:{disable:!this.update_permission}})])])}},L={name:"group_config_index",data:function(){return{kw:"",status:null,group_name:null}},computed:{is_admin:function(){return this.$store.state.user.is_admin||!1}},methods:{render_header:function(t){var e=this;return t("div",{staticClass:"row items-center",style:{height:"36px",minHeight:"36px",borderBottom:"1px solid var(--q-color-grey-5)"}},[t("q-btn",{staticClass:"no-ripple shadow-0 q-ml-sm font-13",style:{height:"20px"},props:{flat:!1,label:"新增",color:"primary",disable:!this.is_admin}},[this.is_admin?t("q-popover",{staticClass:"font-13 bg-grey-2"},[t("div",{staticClass:"q-pa-sm text-weight-bold"},"创建团队"),t("q-input",{staticClass:"q-ml-sm q-mr-sm",props:{placeholder:"请输入团队名称",hideUnderline:!0,value:this.group_name},on:{input:function(t){return e.group_name=t}}},[]),t("div",{staticClass:"q-pa-sm no-wrap font-12 float-right"},[t("q-btn",{props:{label:"创建",color:"primary",flat:!0},directives:[{name:"close-overlay"}],on:{click:function(){var t,r;(t=e.group_name,r={name:t},Object(s.a)({url:"/api/bus/group",method:"post",data:r})).then(function(t){1===t.status?(e.$q.ok("创建成功!"),e.$refs.group_catalog.refresh_catalog(e.kw)):e.$q.err(t.message)})}}}),t("q-btn",{props:{label:"取消",flat:!0},directives:[{name:"close-overlay"}]})])]):null])])},render_body:function(t){return t("div",{staticClass:"col-grow flex no-wrap"},[t(g,{ref:"group_catalog",props:{kw:this.kw,status:this.status},on:{input:this.select_group}}),t("div",{staticClass:"bg-grey-5",style:{width:"1px",minWidth:"1px"}}),t(D,{staticClass:"col-grow",ref:"group_detail",on:{update:this.refresh_catalog}})])},refresh_catalog:function(){this.$refs.group_catalog.refresh_catalog(this.kw,this.status)},select_group:function(t){this.$refs.group_detail.select_group(t)}},render:function(t){return t("div",{staticClass:"col-grow font-13 column no-wrap"},[this.render_header(t),this.render_body(t)])}};var E={name:"comp_admin_catalog",props:{disable:Boolean},data:function(){return{steps:[{id:1,name:"STEP1"}],edit_mode:!1,users:[]}},computed:{c_members:function(){var t={};return this.users.forEach(function(e){if(e.account){var r=e.account[0],i=t[r]||[];i.push(e),t[r]=i}}),t}},methods:{render_admin_catalog:function(t){var e=this,r=n()(this.c_members);return t("div",{staticClass:"column no-wrap q-py-sm"},r.length?r.map(function(r){return t("div",{staticClass:"flex items-start no-wrap q-mb-md"},[t("div",{staticClass:"font-18 text-faded",style:{height:"26px",lineHeight:"26px",width:"30px",flexShrink:0}},r.toUpperCase()),e.render_group_members(t,e.c_members[r])])}):[t("div",{staticClass:"text-light"},"无数据")])},render_group_members:function(t,e){var r=this;return t("div",{staticClass:"flex"},e.map(function(e){return r.render_group_member_item(t,e)}))},render_group_member_item:function(t,e){var r=this;return t("div",{staticClass:"flex no-wrap items-center justify-between pp-border pp-radius bg-grey-2 q-px-xs q-mr-md q-mb-xs",style:{height:"26px",lineHeight:"26px",width:"165px",flexShrink:0}},[t("div",{staticClass:"text-tertiary text-weight-medium ellipsis"},e.name+"（"+e.account+"）"),t("q-icon",{staticClass:"font-16 cursor-pointer text-grey-4 pp-selectable-color-red",props:{name:"cancel"},nativeOn:{click:function(){return r.remove_user(e)}}})])},remove_user:function(t){var e,r,i=this;t&&t.account&&(e=t.account,r={account:e},Object(s.a)({url:"/api/admin/_delete",method:"delete",params:r})).then(this.refresh).catch(function(){return i.$q.err("删除失败")})},refresh:function(){var t,e,r=this;(e={kw:t},Object(s.a)({url:"/api/admin/_search",method:"get",params:e})).then(function(t){return r.users=t.data||[]}).catch(function(){return r.$q.err("查询人员列表异常")})}},render:function(t){var e=this;return t(b,{staticClass:"q-mb-md",props:{label:"添加管理员",collapse:!1}},[this.render_admin_catalog(t),t(P,{staticClass:"no-border no-padding",props:{multiple:!1,filter_out_account:this.users.map(function(t){return t.account}),auto_hide:!1},on:{input:function(t){var r,i,n;(r=t.name,i=t.account,n={account:i,name:r},Object(s.a)({url:"/api/admin",method:"post",data:n})).then(function(t){1===t.status?e.refresh():e.$q.err(t.message)})}},scopedSlots:{field_content:function(t,e){return e(U,{props:{tooltip:"添加人员"}},"add")}},slot:"before"})])}},N={name:"admin_index",data:function(){return{}},methods:{render_admin_options:function(t){return t("div",{staticClass:"scroll",style:{paddingLeft:"5px",paddingTop:"3px"}},[t(E,{ref:"CompAdminCatalog"})])}},render:function(t){return t("div",{staticClass:"col-grow font-13 column no-wrap"},[this.render_admin_options(t)])},mounted:function(){this.$refs.CompAdminCatalog.refresh()}},V=r("fEHC"),F={all:"所有",created_by_me:"我创建的",owner_by_me:"我负责的"},I={name:"comp_datasource_catalog",data:function(){return{kw:null,datasource:null,datasource_list:[],group:null,groups:[],collection_list:[],query_type:"all"}},watch:{query_type:{immediate:!0,handler:function(t,e){t&&this.refresh_catalog()}}},methods:{render_search:function(t){var e=this;return t("div",{},[t(u.a,{staticClass:"pp-search-input",style:{margin:"3px"},props:{value:this.kw,placeholder:"按名称查找",width:"100%"},on:{input:function(t){e.kw=t,e.$nextTick(e.refresh_catalog)}}})])},render_group_catalog_item:function(t,e){var r=this;return t("div",{staticClass:"q-pl-sm q-pr-sm flex no-wrap justify-between cursor-pointer text-left",class:{"bg-grey-3":this.group&&this.group.group_id===e.group_id},style:{lineHeight:"36px"},on:{click:function(){return r.select_group(e)}},key:e.group_id},[t("div",{staticClass:"ellipsis"},e.group_name)])},render_group_catalog:function(t){var e=this;return t("div",{style:{borderRight:"1px solid var(--q-color-grey-5)",width:"100px",minHeight:"96vh",maxHeight:"100%"}},[this.collection_list.map(function(r){return[e.render_group_catalog_item(t,r),t("q-item-separator",{staticClass:"q-ma-none"})]})])},render_datasource_catalog_item:function(t,e){var r=this;return t("div",{staticClass:"pp-selectable-bg q-pl-sm q-pr-sm row no-wrap justify-between cursor-pointer text-left",class:{"pp-selected-bg":this.datasource&&this.datasource.id===e.id},style:{lineHeight:"36px"},on:{click:function(){return r.select_datasource(e)}},key:e.id},[t("i",{staticClass:"mdi "+l.b[e.type].icon+" text-"+l.b[e.type].color,style:{fontSize:"22px"}}),t("div",{staticClass:"ellipsis col-grow"},[t("span",e.name)]),t("div",{style:{width:"30px",minWidth:"30px"}},[l.a[e.status].label])])},render_datasource_catalog:function(t){var e=this;return t("div",{style:{width:"200px"}},[null!=this.datasource_list&&this.datasource_list&&this.datasource_list.map(function(r){return[e.render_datasource_catalog_item(t,r),t("q-item-separator",{staticClass:"q-ma-none"})]})])},refresh_catalog:function(t){this.datasource_list=[],this.collection_list=[],t&&void 0!==t&&(this.group=t.group||null,this.datasource=t.datasource||null,this.$emit("select",this.datasource)),this.search_all_datasource_list(this.kw)},search_all_datasource_list:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.kw;e=e||null;var r=this;Object(V.c)(e,null,this.query_type).then(function(e){1===e.status&&(r.collection_list=r.collection_list.concat(t.deal_data_to_folder_list(e.data)||[]),null!==t.group?r.collection_list.forEach(function(e){e.group_id===t.group.group_id&&(t.group=e)}):null===t.group&&r.collection_list.length>0&&(t.group=r.collection_list[0]),null!==t.group&&t.group.children&&(t.datasource_list=t.group.children||[],t.datasource_list.length>0&&null===t.datasource&&t.select_datasource(t.datasource_list[0])))}).catch(function(){return t.$q.err("获取排查工具列表异常")})},select_datasource:function(t){this.datasource=t,this.$emit("select",t)},select_group:function(t){this.group=t,this.datasource_list=t.children||[],this.datasource=null,this.datasource_list.length>0&&null===this.datasource&&this.select_datasource(this.datasource_list[0])},deal_data_to_folder_list:function(t){var e=[];return t.map(function(t){for(var r={},i=!1,n=0,s=0;s<e.length;s++)if(e[s].group_id===t.group_id){i=!0,n=s;break}if(i){var o=e[n].children;t.id&&o.push(t),r={group_id:t.group_id,children:o,group_name:t.group_name},e.splice(n,1,r)}else{var a=[];t.id&&a.push(t),r={group_id:t.group_id,children:a,group_name:t.group_name},e.push(r)}}),e}},render:function(t){var e=this;return t("transition",{props:{appear:!0,mode:"out-in",enterActiveClass:"animate-popup-down"}},[t("div",{style:{height:"96%"}},[t(_,{props:{value:this.query_type,options:n()(F)},scopedSlots:{item:function(t){return F[t]}},on:{select:function(t){e.query_type=t}}}),this.render_search(t),t("div",{staticClass:"no-wrap row",style:{height:"100%"}},[this.render_group_catalog(t),this.render_datasource_catalog(t)])])])}};var J=r("Cf0S"),G={name:"ppTimePicker",mixins:[J.a],data:function(){return{popup_fit:!1,colorArray:["#e0e0e0","#f8bbd0","#ffcdd2","#e1bee7","#90caf9","#fff59d ","#c8e6c9 ","#bdbdbd","#f48fb1","#ef9a9a","#ce93d8","#42a5f5","#fff176 ","#a5d6a7 ","#616161","#f06292","#e57373","#ba68c8","#2196f3","#ffee58 ","#81c784 ","#424242","#e91e63","#ef5350","#ab47bc","#2196f3","#ffeb3b ","#66bb6a ","#212121","#d81b60","#f44336","#9c27b0","#1565c0","#ffeb3b ","#4caf50 "]}},methods:{render_field_content:function(t){return t("div",{staticClass:"flex no-wrap items-center full-width q-pl-xs q-pr-xs"})},__render_placeholder:function(t){return"function"==typeof this.placeholder?this.placeholder(t):t("span",{style:{color:"#979797",fontSize:this.fontSize,padding:"0 4px"}},[t("q-icon",{style:"color:#000",props:{name:"format_color_text"}})])},render_ftColor_card:function(t,e){var r=this;return t("button",{staticClass:"cursor-pointer",style:{width:"10px",height:"10px",outline:"none",margin:"0 5px",border:"none",backgroundColor:e},on:{click:function(t){document.execCommand("foreColor",!1,e),r.$refs.popup.hide()}}})},__render_list:function(t){var e=this;return t("div",{style:{padding:"6px"}},[t("div",{style:{width:"154px",margin:"auto"}},[this.colorArray.map(function(r){return e.render_ftColor_card(t,r)})]),t("q-collapsible",{staticClass:"font-12",props:{label:"更多颜色"}},[t("q-color-picker",{props:{formatModel:"hex"},on:{change:function(t){e.$emit("click",t)}}})])])}}},Y=r("RRo+"),K=r.n(Y),X={name:"PjmField",props:{label:String,labelClass:{type:String,default:"text-dark"},count:{type:[Number,Boolean],default:!1},error:Boolean,errorLabel:String,warning:Boolean,warningLabel:String,helper:String,dark:Boolean,labelWidth:{type:[Number,String],default:85},fontSize:{type:Number,default:13},required:Boolean},data:function(){return{input:{}}},computed:{hasError:function(){return this.input.error||this.error},hasWarning:function(){return!this.hasError&&(this.input.warning||this.warning)},childHasLabel:function(){return this.input.floatLabel||this.input.stackLabel},isDark:function(){return this.input.dark||this.dark},hasNoInput:function(){return!this.input.$options||this.input.__needsBorder},counter:function(){if(this.count){var t=this.input.length||"0";return K()(this.count)?t+" / "+this.count:t}},classes:function(){return{"q-field-horizontal":!0,"q-field-floating":this.childHasLabel,"q-field-no-label":!this.label&&!this.$slots.label,"q-field-with-error":this.hasError,"q-field-with-warning":this.hasWarning,"q-field-dark":this.isDark}}},provide:function(){return{__field:this}},methods:{__registerInput:function(t){this.input=t},__unregisterInput:function(t){t&&t!==this.input||(this.input={})},__getBottomContent:function(t){var e=void 0;return this.hasError&&(e=this.$slots["error-label"]||this.errorLabel)?t("div",{staticClass:"q-field-error col"},e):this.hasWarning&&(e=this.$slots["warning-label"]||this.warningLabel)?t("div",{staticClass:"q-field-warning col"},e):(e=this.$slots.helper||this.helper)?t("div",{staticClass:"q-field-helper col"},e):t("div",{staticClass:"col"})},__hasBottom:function(){return this.hasError&&(this.$slots["error-label"]||this.errorLabel)||this.hasWarning&&(this.$slots["warning-label"]||this.warningLabel)||this.$slots.helper||this.helper||this.count}},render:function(t){var e=this.$slots.label||this.label;return t("div",{staticClass:"q-field row no-wrap",class:this.classes},[t("div",{staticClass:"row col no-wrap items-center",style:{fontSize:this.fontSize+"px",minHeight:"24px"}},[e?t("div",{staticClass:"q-field-label flex no-wrap text-weight-bold "+(this.hasError||this.hasWarning?null:this.labelClass),style:{width:this.labelWidth+"px",minWidth:this.labelWidth+"px"}},[t("div",{staticClass:"text-red",style:{width:"8px"}},this.required?"*":null),this.$slots.label||this.label]):null,t("div",{staticClass:"q-field-content col-grow",style:{overflow:"hidden"}},[this.$slots.default,this.__hasBottom()?t("div",{staticClass:"q-field-bottom row no-wrap",class:{"q-field-no-input":this.hasNoInput}},[this.__getBottomContent(t),this.counter?t("div",{staticClass:"q-field-counter col-auto"},[this.counter]):null]):null])])])}},Q={name:"Editor",data:function(){return{fz:["12","13","16","18","24","32","48"],fontLabel:"12"}},props:{desText:"",toolBarHide:!1,readonly:!1,editorStyle:{},contentStyle:{}},computed:{editFz:function(){for(var t=this,e=this.fz.length,r=[],i=function(e){r["font"+t.fz[e]]={cmd:"fontSize",param:e+1,tip:t.fz[e],label:t.fz[e],icon:t.fz[e],handler:function(){t.fontLabel=t.fz[e],document.execCommand("fontSize",!1,e+1)}}},n=0;n<e;n++)i(n);return r},fontSizeTitles:function(){return this.fz.map(function(t){return"font"+t})},description:function(){return this.desText}},methods:{init:function(){this.fontLabel=this.fz[0]},render_model_editor:function(t){var e=this;return t("div",{staticClass:"editor-full-screen relative-position"},[t("q-editor",{class:this.toolBarHide?"no-border":"",staticClass:"describe-edit no-ripple",ref:"editor",style:this.editorStyle,props:{value:this.description,placeholder:"描述",readonly:this.readonly,toolbar:this.toolBarHide?[]:[["bold","fonts_color_btn"],["left","center","right","justify"],["ordered","unordered"],["undo","redo"],["save"]],definitions:h()({bold:{label:null,tip:"加粗"},undo:{tip:"撤销"},redo:{tip:"前进"},left:{tip:"居左"},center:{tip:"居中"},right:{tip:"居右"},justify:{tip:"自动"},ordered:{tip:"有序列表"},unordered:{tip:"无序列表"},save:{tip:"保存",icon:"save",color:"primary",handler:this.saveWork},link:{tip:"超链接"}},this.editFz),toolbarBg:"white",contentStyle:h()({overflow:"auto"},this.contentStyle)},on:{input:function(t){e.$emit("input",t)}}})])},render_font_color:function(t){return t("q-btn",{slot:"fonts_color_btn"},[t(X,{},[t(G,{on:{click:function(t){document.execCommand("foreColor",!1,t)}}})])])},saveWork:function(){this.$emit("save")}},render:function(t){return this.render_model_editor(t)},activated:function(){this.init()}},Z={name:"BusGroupSelector",mixins:[J.a],props:{},data:function(){return{filter_distinct_key:"label",distinctKey:"value"}},methods:{render_field_content:function(t,e){return e.label?this.render_field_item(t,e):this.__render_placeholder(t)},render_field_item:function(t,e){return[t("span",{staticClass:"q-mr-xs font-13"},e.label)]},__render_list:function(t){return t("q-list",{staticClass:"q-pt-xs q-pb-xs column no-border",props:{link:!0,dense:!0}},[this.__render_list_content(t)])},render_list_content:function(t,e){return t("span",{staticClass:"q-ml-xs q-mr-xs font-12 pp-sentence"},e.label)},search:function(){var t=this;o(null,1).then(function(e){t.raw_options=e.data.map(function(t){return{value:t.id,label:t.name}})}).catch(function(e){return t.$q.err("获取团队列表异常")})}}};var tt={name:"DatasourceTypeSelector",mixins:[J.a],props:{},data:function(){return{filter_distinct_key:"label",distinctKey:"value",auto_close:!0}},methods:{render_field_content:function(t,e){return e.label?this.render_field_item(t,e):this.__render_placeholder(t)},render_field_item:function(t,e){return[t("i",{staticClass:"mdi "+l.b[e.value].icon+" text-"+l.b[e.value].color,style:{fontSize:"22px"}}),t("span",{staticClass:"q-mr-xs font-13"},e.label)]},__render_list:function(t){return t("q-list",{staticClass:"q-pt-xs q-pb-xs column no-border",props:{link:!0,dense:!0}},[this.__render_list_content(t)])},render_list_content:function(t,e){return t("div",{},[t("i",{staticClass:"mdi "+l.b[e.value].icon+" text-"+l.b[e.value].color,style:{fontSize:"22px"}}),t("span",{staticClass:"q-ml-xs q-mr-xs font-12  pp-sentence"},e.label)])},search:function(){this.raw_options=l.c}}},et={name:"comp_datasource_detail",data:function(){return{datasource:{},owners:[],connection_error:null,update_permission:!1}},props:{datasource_id:{required:!0,type:[Number,String]}},watch:{datasource_id:{immediate:!0,handler:function(t,e){t&&this.query_datasource(t)}}},computed:{disable:function(){return!this.datasource},group:function(){return this.datasource&&this.datasource.group_id?{value:this.datasource.group_id,label:this.datasource.group_name}:null},datasource_type:function(){return this.datasource&&this.datasource.type?{value:this.datasource.type,label:l.b[this.datasource.type].label}:null}},methods:{render_base_info:function(t){var e=this;return t(b,{staticClass:"q-mb-md"},[t("div",{slot:"label",staticClass:"q-mr-xs text-weight-bold"},["基础信息"]),t("div",{staticClass:"row no-wrap"},[t("div",{staticClass:"col-12"},[this.render_tr(t,"名称：",t("q-input",{style:{minWidth:"200px",maxWidth:"200px"},props:{placeholder:"请输入数据源名称",value:this.datasource.name,hideUnderline:!0,disable:!this.update_permission,after:[{icon:"keyboard_return",handler:function(){Object(V.i)(e.datasource.id,{name:e.datasource.name}).then(function(t){1===t.status?(e.$emit("update"),e.$q.ok("修改成功!")):e.$q.err(t.message)})}}]},on:{input:function(t){return e.datasource.name=t}}})),this.render_tr(t,"类型：",t(tt,{props:{value:this.datasource_type,placeholder:"请选择类型",disable:!this.update_permission},on:{input:function(t){e.datasource.type=t.value,Object(V.i)(e.datasource.id,{type:e.datasource.type})}}})),this.render_tr(t,"所属团队：",t(Z,{props:{value:this.group,placeholder:"请选择所属团队",disable:!this.update_permission},on:{input:function(t){e.datasource.group_id=t.value,e.datasource.group_name=t.label,Object(V.i)(e.datasource.id,{group_id:e.datasource.group_id})}}})),this.render_tr(t,"负责人：",t(R.a,{props:{value:this.owners,placeholder:"请选择负责人",disable:!this.update_permission},on:{input:function(t){var r,i;e.owners=t,(r=e.datasource.id,i=e.owners,Object(s.a)({url:"/api/datasource/"+r+"/owners",method:"patch",data:i})).then().catch()}}})),this.render_tr(t,"创建人：",this.datasource.creator_name),this.render_tr(t,"创建时间：",Object(v.a)(this.datasource.create_time,"YYYY-MM-DD HH:mm:ss"))])])])},render_tr:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"q-pa-xs text-tertiary text-left";return t("tr",null,[t("td",{staticClass:"q-pa-xs",style:{textAlign:"left",whiteSpace:"nowrap"}},e),t("td",{staticClass:i},r?[r]:"--")])},render_description:function(t){var e,r=this;return t(b,{staticClass:"q-mb-md",props:{label:"描述",collapse:!1}},[t(Q,{staticClass:"no-border text-tertiary",style:{whiteSpace:"pre-warp",overflow:"auto",textAlign:"left"},props:{contentStyle:{minHeight:0,fontSize:"13px",backgroundColor:"transparent",whiteSpace:"pre-wrap"},desText:this.datasource.description?(e=this.datasource.description,e.replace(/((http|ftp|https):\/\/)?[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/g,function(t){return"<a href='"+(t.indexOf("http")>-1?t:"http://"+t)+'\' target=_blank style="text-decoration:none">'+t+"</a>"})):"",readonly:!this.update_permission},on:{save:function(){Object(V.i)(r.datasource.id,{description:r.datasource.description}).then(function(t){1===t.status&&r.$q.ok("保存成功！")})},input:function(t){r.datasource.description=t}}})])},render_connection_info:function(t){var e=this;return t(b,{staticClass:"q-mb-md"},[t("div",{slot:"label",staticClass:"q-mr-xs text-weight-bold"},["连接配置"]),t("div",{staticClass:"row no-wrap"},[t("div",{staticClass:"col-12"},[this.render_tr(t,"连接地址：",t("q-input",{style:{minWidth:"200px",maxWidth:"200px"},props:{placeholder:"请输入服务器IP",value:this.datasource.ip,hideUnderline:!0,disable:!this.update_permission,after:[{icon:"keyboard_return",handler:function(){Object(V.i)(e.datasource.id,{ip:e.datasource.ip,port:e.datasource.port,username:e.datasource.username,password:e.datasource.password,db:e.datasource.db}).then(function(t){1===t.status?e.$q.ok("修改成功!"):e.$q.err(t.message)})}}]},on:{input:function(t){return e.datasource.ip=t}}})),this.render_tr(t,"端口：",t("q-input",{style:{minWidth:"200px",maxWidth:"200px"},props:{placeholder:"请输入服务器端口",value:this.datasource.port,hideUnderline:!0,disable:!this.update_permission,after:[{icon:"keyboard_return",handler:function(){Object(V.i)(e.datasource.id,{ip:e.datasource.ip,port:e.datasource.port,username:e.datasource.username,password:e.datasource.password,db:e.datasource.db}).then(function(t){1===t.status?e.$q.ok("修改成功!"):e.$q.err(t.message)})}}]},on:{input:function(t){return e.datasource.port=t}}})),this.render_tr(t,"用户名：",t("q-input",{style:{minWidth:"200px",maxWidth:"200px"},props:{placeholder:"请输入登录用户名",value:this.datasource.username,hideUnderline:!0,disable:!this.update_permission,after:[{icon:"keyboard_return",handler:function(){Object(V.i)(e.datasource.id,{ip:e.datasource.ip,port:e.datasource.port,username:e.datasource.username,password:e.datasource.password,db:e.datasource.db}).then(function(t){1===t.status?e.$q.ok("修改成功!"):e.$q.err(t.message)})}}]},on:{input:function(t){return e.datasource.username=t}}})),this.render_tr(t,"密码：",t("q-input",{style:{minWidth:"200px",maxWidth:"200px"},props:{placeholder:"请输入登录密码",value:this.datasource.password,type:"password",hideUnderline:!0,clearable:!0,disable:!this.update_permission,after:[{icon:"keyboard_return",handler:function(){Object(V.i)(e.datasource.id,{ip:e.datasource.ip,port:e.datasource.port,username:e.datasource.username,password:e.datasource.password,db:e.datasource.db}).then(function(t){1===t.status?e.$q.ok("修改成功!"):e.$q.err(t.message)})}}]},on:{input:function(t){return e.datasource.password=t}}})),this.render_tr(t,"激活：",t("q-toggle",{staticClass:"text-left",props:{leftLabel:!0,value:1===this.datasource.status,color:"deep-orange",disable:!this.update_permission},on:{input:function(t){e.connection_error=null,Object(V.i)(e.datasource.id,{ip:e.datasource.ip,port:e.datasource.port,username:e.datasource.username,password:e.datasource.password,db:e.datasource.db}).then(function(){return Object(V.a)(e.datasource.id).then(function(r){1===r.status?(e.datasource.status=!0===t?1:-1,!0===t?e.$q.ok("已激活！"):e.$q.ok("已失效！"),e.$emit("update")):(e.connection_error=r.message,e.$q.err("数据库连接失败！"))})})}}})),this.connection_error?this.render_tr(t,"连接异常：",t("div",{staticClass:"text-left text-negative text-weight-bold pp-border-3 q-pa-sm"},[this.connection_error])):null])])])},select_datasource:function(t){t&&t.id&&this.query_datasource(t.id)},query_datasource:function(t){var e=this;Object(T.b)(t).then(function(t){1===t.status&&(e.update_permission=t.data)}).then(function(){var r;Object(V.d)(t).then(function(t){return e.datasource=t.data||{}}).catch(function(){return e.$q.err("获取数据源配置异常")}),(r=t,Object(s.a)({url:"/api/datasource/"+r+"/owners",method:"get"})).then(function(t){e.owners=t.data||[]}).catch()})}},render:function(t){return t("transition",{props:{appear:!0,mode:"out-in",enterActiveClass:"animate-popup-down"}},[t("div",{staticClass:"scroll",style:{paddingLeft:"10px",paddingTop:"3px"}},[this.render_base_info(t),this.update_permission?this.render_connection_info(t):null,this.render_description(t)])])}},rt=r("3ria"),it=r("+cKO"),nt={name:"createTroubleModal",mixins:[rt.a],props:{},data:function(){return{model:{name:null,description:null,group_id:null,group_name:null,type:null},generic_placeholder:"待添加",labelWidth:110,minWidth:"550px",maxWidth:"550px",group:null,datasource_type:null}},validations:{model:{name:{required:it.required},group_id:{required:it.required},type:{required:it.required}}},watch:{group:{handler:function(t,e){t&&t.value&&(this.model.group_id=t.value)},deep:!0,immediate:!0},datasource_type:{handler:function(t,e){t&&t.value&&(this.model.type=t.value)},deep:!0,immediate:!0}},methods:{title:function(){return"创建数据源"},init:function(){this.model={name:null,description:null,group_id:null,group_name:null,type:null},this.group=null,this.datasource_type=null},submit:function(t){var e=this,r=t.done,i=t.close;Object(V.b)(this.model.name,this.model.type,this.model.group_id,this.model.description).then(function(t){1===t.status&&(i(),e.$emit("submit",{group:{group_id:e.group.value,group_name:e.group.label},datasource:h()({id:t.data},e.model)}))}).catch(function(){r(),e.$q.err("添加数据源失败!")})},cancel:function(){},field_class:function(t){return"q-mb-md "+t},render_contents:function(t){return[this.render_name(t),this.render_type(t),this.render_group(t),this.render_description(t)]},render_name:function(t){var e=this;return t(X,{staticClass:this.field_class(),props:{labelWidth:this.labelWidth,label:"名称",required:!0,error:this.$v.model.name.$error}},[t("q-input",{props:{color:"tertiary",value:this.model.name,placeholder:this.generic_placeholder,hideUnderline:!0},on:{input:function(t){return e.model.name=t}}})])},render_type:function(t){var e=this;return t(X,{staticClass:this.field_class(),props:{labelWidth:this.labelWidth,label:"类型",required:!0,error:this.$v.model.type.$error}},[t(tt,{props:{value:this.datasource_type,placeholder:this.generic_placeholder},on:{input:function(t){return e.datasource_type=t}}})])},render_group:function(t){var e=this;return t(X,{staticClass:this.field_class(),props:{labelWidth:this.labelWidth,label:"所属团队",required:!0,error:this.$v.model.group_id.$error}},[t(Z,{props:{value:this.group,placeholder:this.generic_placeholder},on:{input:function(t){e.group=t,e.$emit("group",t)}}})])},render_description:function(t){var e=this;return t(Q,{props:{desText:this.model.description||"",placeholder:"描述",contentStyle:{minHeight:50,fontSize:"13px",backgroundColor:"transparent",whiteSpace:"pre-wrap"}},on:{input:function(t){e.model.description=t,e.$emit("description",t)}}})}}},st={name:"ppSectionCard",props:{label:String,animate_key:[String,Number]},data:function(){return{fakeValue:!0}},watch:{animate_key:function(){this.animate_show()}},methods:{render_head:function(t){return t("div",{staticClass:"flex items-center no-wrap",style:{minHeight:"24px"}},[this.$slots.label||t("div",{staticClass:"text-weight-bold q-px-xs font-13"},this.label),this.$slots.before,t("div",{staticClass:"col-grow"}),this.$slots.after])},render_content:function(t){return this.$slots.content?this.$slots.content:t("div",{staticClass:"q-pa-sm pp-radius bg-white",style:{border:"1px solid #d0d0d0"}},this.$slots.default)},animate_show:function(){this.$el&&this.$el.classList.add("card-animate-pop-down")},remove_animate:function(){this.$el&&this.$el.classList.remove("card-animate-pop-down")}},render:function(t){return t("transition",{props:{appear:!0,mode:"out-in",enterActiveClass:"card-animate-pop-down"}},[t("div",{staticClass:""},[this.render_head(t),this.render_content(t)])])},mounted:function(){var t=this;this.$nextTick(function(){return t.$el.addEventListener("animationend",t.remove_animate,!1)})}},ot=r("GDK7");var at={props:{value:Boolean,disable:Boolean},render:function(t){return this.render_btn(t)},methods:{render_btn:function(t){var e=this,r=this.value?"check_box":"check_box_outline_blank";return t("i",{staticClass:"material-icons font-16 text-center",class:{"cursor-not-allowed":this.disable,"cursor-pointer":!this.disable,"text-primary":this.value,"text-faded":!this.value},style:{opacity:this.disable?.5:1,width:"20px",height:"20px",lineHeight:"20px",flexShrink:0},on:{click:function(){return e.disable?null:e.$emit("input",!e.value)}}},r)}}},ut={name:"section_datasource_permission",props:{datasource_id:[String,Number],disable:Boolean},mixins:[ot.a],data:function(){return{table_columns:[],query_switch:!0,update_permission:!1}},watch:{datasource_id:{handler:function(){this.request(),this.request_get_query_switch()},immediate:!0}},mounted:function(){this.assemble_column()},methods:{render_scope_slot:function(t,e){var r=this;e.header=function(e){return t("q-tr",{props:e},r.table_columns.map(function(r){return t("q-td",{staticClass:"font-12 text-faded text-weight-medium",class:[r.label_bg,"text-"+(r.align||"center")],props:e,key:r.name},[r.header_render?r.header_render(t):r.label])}))}},assemble_column:function(){var t=this;Object(T.d)().then(function(e){var r=e.data,i=[];i.push({name:"name",align:"left",field:"name",label:"账号",header_render:function(e){return e("div",{staticClass:"flex no-wrap items-center"},[e(P,{staticClass:"no-border no-padding",props:{multiple:!1,filter_out_account:t.rows.map(function(t){return t.account}),auto_hide:!1,include_group:!0,disable:t.disable},on:{input:t.add_member},scopedSlots:{field_content:function(e,r){return r(B,{staticClass:"font-12 q-py-xxs",style:{minHeight:"26px",lineHeight:"26px"},props:{outline:!0,color:"primary",label:"添加人员",disable:!t.update_permission}})}},slot:"before"})])},renderData:{style:{width:"200px"}},render:function(t,e){var r=e.row;return t("div",{staticClass:"flex no-wrap items-center"},[t("i",{staticClass:"material-icons text-faded pp-radius font-16 q-mr-xs"},"person"),t("div",r.name),t("div",{staticClass:"q-ml-xs"},r.account)])}}),i.push({name:"auth_space",header_render:function(t){return t("div",{staticClass:"text-right font-14 text-light"},"权限")},render:function(t){return""}}),r.forEach(function(e,r){return i.push({name:e.type,align:"center",field:"auth_list",label:e.desc,label_bg:r%2==0?"bg-grey-2":"",renderData:{class:{"bg-grey-2":r%2==0}},render:function(r,i){return r(at,{staticClass:"pp-selectable-bg-grey-4 pp-radius ",props:{value:(n=i.value,s=e,n.some(function(t){return t.option_type===s.type})),disable:!t.update_permission},on:{input:function(r){return t.update_auth(r,i.row.account,e.type)}}});var n,s}})}),i.push({name:"remove",align:"center",render:function(e,r){return e(U,{props:{color:"faded",disable:!t.update_permission,tooltip:"移除人员"},on:{input:function(){return t.delete(r.row)}}},"delete")}}),t.table_columns=t.table_columns.concat(i)}).catch(function(){return t.$q.err("获取数据异常")})},request:function(){var t=this;this.datasource_id&&Object(T.b)(this.datasource_id).then(function(e){1===e.status&&(t.update_permission=e.data)}).then(function(){var e;(e=t.datasource_id,Object(s.a)({url:"/api/datasource/"+e+"/permission/member",method:"get"})).then(function(e){t.rows=e.data||[],t.rowsNumber=e.data.length}).catch(function(){return t.$q.err("获取人员异常")})})},request_get_query_switch:function(){var t=this;this.datasource_id&&Object(V.d)(this.datasource_id).then(function(e){return t.query_switch=1===e.data.query_switch}).catch(function(){return t.$q.err("获取权限控制标识位异常")})},add_member:function(t){var e=this,r={account:t.account,name:t.name};this.datasource_id&&function(t,e){return Object(s.a)({url:"/api/datasource/"+t+"/permission/member",method:"post",data:e})}(this.datasource_id,r).then(this.request).catch(function(){return e.$q.err("添加人员异常")})},delete:function(t){var e,r,i=this;t&&t.account&&(e=this.datasource_id,r=t.account,Object(s.a)({url:"/api/datasource/"+e+"/permission/member",method:"delete",params:{account:r}})).then(this.request).catch(function(){return i.$q.err("删除人员异常")})},update_auth:function(t,e,r){var i,n,o=this;e&&r&&(t?(i=this.datasource_id,n={account:e,option_type:r},Object(s.a)({url:"/api/datasource/"+i+"/permission/sql/options",method:"post",data:n})).then(this.request).catch(function(){return o.$q.err("添加权限异常")}):function(t,e){return Object(s.a)({url:"/api/datasource/"+t+"/permission/sql/options",method:"delete",params:e})}(this.datasource_id,{account:e,option_type:r}).then(this.request).catch(function(){return o.$q.err("移除权限异常")}))},update_query_switch:function(t){var e=this;this.datasource_id&&Object(V.i)(this.datasource_id,{query_switch:t?1:-1}).then(this.request_get_query_switch).catch(function(){return e.$q.err("更新权限控制标识位异常")})}},render:function(t){return t(st,[t("q-table",{staticClass:"shadow-0 overflow-hidden",props:{dense:!0,color:"primary",data:this.rows,columns:this.table_columns,pagination:{rowsPerPage:null},rowKey:"account",noDataLabel:"无数据",hideBottom:!0,hideHeader:!1,readonly:!this.update_permission,disable:!this.update_permission},scopedSlots:this.__render_scope_slot(t),on:{request:this.__request}}),t("div",{slot:"before"},[t("div",{staticClass:"flex no-wrap items-center"},[t("div",{staticClass:"q-mr-sm font-13 text-tertiary text-weight-medium"},"开放查询权限"),t("q-toggle",{staticClass:"no-ripple",props:{value:this.query_switch,disable:!this.update_permission},on:{input:this.update_query_switch}})]),t("div",{staticClass:"font-11 text-grey q-mb-sm"},['勾选"开放查询权限"后，未配置权限的同学均可进行查询操作！'])])])}},lt=[{key:"base",label:"基本配置",component:function(t,e,r){return t("div",{staticClass:"col-grow column no-wrap scroll q-pa-sm"},[t(et,{staticClass:"col-grow",ref:"DatasourceDetail",props:{datasource_id:e},on:{update:function(){r.$refs.DatasourceCatalog.refresh_catalog()}}})])}},{key:"member",label:"人员/权限配置",component:function(t,e,r){return t("div",{staticClass:"col-grow column no-wrap scroll q-pa-sm bg-grey-1"},[t(ut,{staticClass:"q-ma-sm",props:{datasource_id:e}})])}}],ct={name:"datasource_index",data:function(){return{kw:"",status:null,setting:lt[0],datasource:{}}},computed:{datasource_id:function(){return this.datasource?this.datasource.id:null}},methods:{render_header:function(t){var e=this;return t("div",{staticClass:"row items-center",style:{height:"36px",minHeight:"36px",borderBottom:"1px solid var(--q-color-grey-5)",borderRight:"1px solid var(--q-color-grey-5)"}},[t("q-btn",{staticClass:"no-ripple shadow-0 font-13 q-ml-sm",style:{height:"20px"},props:{flat:!1,label:"新增",color:"primary"},on:{click:this.show_create_modal}}),t(nt,{ref:"DatasourceCreateModal",on:{submit:function(t){e.refresh_catalog(t)}}})])},render_body:function(t){return t("div",{staticClass:"col-grow flex no-wrap"},[t(I,{ref:"DatasourceCatalog",props:{kw:this.kw,status:this.status},on:{select:this.select_trouble}}),t("div",{staticClass:"bg-grey-5",style:{width:"1px",minWidth:"1px"}})])},render_section_list:function(t){var e=this;return t("div",{staticClass:"col-grow column no-wrap scroll"},[t(_,{props:{value:this.setting,distinct_key:"key",options:lt},scopedSlots:{item:function(r,i){return e.render_tab(t,r)}},on:{select:function(t){return e.setting=t}}}),this.render_view(t)])},render_tab:function(t,e){return t("div",{staticClass:"q-pl-md q-pr-md q-pt-sm q-pb-sm text-center",style:{minWidth:"100px"}},e.label)},render_view:function(t){return t("transition",{props:{appear:!1,mode:"out-in",enterActiveClass:"animated fadeIn"}},[this.datasource_id?this.setting.component(t,this.datasource_id,this):t("div",{staticClass:"q-ma-md text-light font-13"},"无数据")])},show_create_modal:function(){this.$refs.DatasourceCreateModal.show()},refresh_catalog:function(t){this.$refs.DatasourceCatalog.refresh_catalog(t)},select_trouble:function(t){this.datasource=t}},render:function(t){return t("div",{staticClass:"col-grow font-13 row no-wrap"},[t("div",{},[this.render_header(t),this.render_body(t)]),this.render_section_list(t)])}};e.default={name:"system_config",data:function(){return{selected:"datasource_config"}},computed:{menu:function(){var t={datasource_config:"数据源配置",group_config:"团队管理"};return this.$store.state.user.is_admin&&(t.admin_config="管理员配置"),t},path:function(){return this.$route.path}},watch:{path:function(t){"/system_config"===t&&(this.selected="trouble_config")}},methods:{render_config_menu:function(t){var e=this;return t("div",{staticClass:"font-14 text-dark q-pt-sm column",style:{borderRight:"1px solid var(--q-color-grey-5)",paddingRight:"4px"}},n()(this.menu).map(function(r){return e.render_menu_item(t,r)}))},render_menu_item:function(t,e){var r=this,i=this.selected===e;return t("div",{staticClass:"pp-selectable-bg cursor-pointer pp-radius-2 text-center",class:{"text-primary":i,"text-weight-bold":i},style:{width:"150px",lineHeight:"34px"},on:{click:function(){return r.selected=e}}},this.menu[e])},render_content:function(t){switch(this.selected){case"group_config":return t(L);case"admin_config":return t(N);case"datasource_config":return t(ct)}}},render:function(t){return t("div",{staticClass:"row col-grow no-wrap q-pl-xs",style:{marginTop:"-10px",minHeight:"100vh"}},[this.render_config_menu(t),this.render_content(t)])}}},Gu7T:function(t,e,r){"use strict";e.__esModule=!0;var i,n=r("c/Tr"),s=(i=n)&&i.__esModule?i:{default:i};e.default=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return(0,s.default)(t)}},"HM/u":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:":";return(0,i.withParams)({type:"macAddress"},function(e){if(!(0,i.req)(e))return!0;if("string"!=typeof e)return!1;var r="string"==typeof t&&""!==t?e.split(t):12===e.length||16===e.length?e.match(/.{2}/g):null;return null!==r&&(6===r.length||8===r.length)&&r.every(n)})};var n=function(t){return t.toLowerCase().match(/^[0-9a-f]{2}$/)}},HSVw:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4"),n=(0,i.withParams)({type:"ipAddress"},function(t){if(!(0,i.req)(t))return!0;if("string"!=typeof t)return!1;var e=t.split(".");return 4===e.length&&e.every(s)});e.default=n;var s=function(t){if(t.length>3||0===t.length)return!1;if("0"===t[0]&&"0"!==t)return!1;if(!t.match(/^\d+$/))return!1;var e=0|+t;return e>=0&&e<=255}},L6Jx:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(t){return(0,i.withParams)({type:"sameAs",eq:t},function(e,r){return e===(0,i.ref)(t,this,r)})}},PKmV:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=(0,r("URu4").regex)("alphaNum",/^[a-zA-Z0-9]*$/);e.default=i},"RRo+":function(t,e,r){t.exports={default:r("c45H"),__esModule:!0}},URu4:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"withParams",{enumerable:!0,get:function(){return n.default}}),e.regex=e.ref=e.len=e.req=void 0;var i,n=(i=r("mpcv"))&&i.__esModule?i:{default:i};function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=function(t){if(Array.isArray(t))return!!t.length;if(void 0===t||null===t)return!1;if(!1===t)return!0;if(t instanceof Date)return!isNaN(t.getTime());if("object"===s(t)){for(var e in t)return!0;return!1}return!!String(t).length};e.req=o;e.len=function(t){return Array.isArray(t)?t.length:"object"===s(t)?Object.keys(t).length:String(t).length};e.ref=function(t,e,r){return"function"==typeof t?t.call(e,r):r[t]};e.regex=function(t,e){return(0,n.default)({type:t},function(t){return!o(t)||e.test(t)})}},Xd8P:function(t,e){},Y18q:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return(0,i.withParams)({type:"or"},function(){for(var t=this,r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return e.length>0&&e.reduce(function(e,r){return e||r.apply(t,i)},!1)})}},aYrh:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(t){return(0,i.withParams)({type:"minValue",min:t},function(e){return!(0,i.req)(e)||(!/\s/.test(e)||e instanceof Date)&&+e>=+t})}},"bXE/":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return(0,i.withParams)({type:"and"},function(){for(var t=this,r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return e.length>0&&e.reduce(function(e,r){return e&&r.apply(t,i)},!0)})}},"c/Tr":function(t,e,r){t.exports={default:r("5zde"),__esModule:!0}},c45H:function(t,e,r){r("1alW"),t.exports=r("FeBl").Number.isInteger},eqrJ:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=(0,r("URu4").regex)("integer",/^-?[0-9]*$/);e.default=i},fBQ2:function(t,e,r){"use strict";var i=r("evD5"),n=r("X8DO");t.exports=function(t,e,r){e in t?i.f(t,e,n(0,r)):t[e]=r}},hbkP:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=(0,r("URu4").regex)("numeric",/^[0-9]*$/);e.default=i},lEk1:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(t){return(0,i.withParams)({type:"requiredIf",prop:t},function(e,r){return!(0,i.ref)(t,this,r)||(0,i.req)(e)})}},mpcv:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i="web"===Object({NODE_ENV:"production"}).BUILD?r("tL8V").withParams:r("JVqD").withParams;e.default=i},obBT:function(t,e,r){"use strict";var i=r("NHnr"),n=function(t,e,r,n){if(t&&e){var s=i.vm.$q.localStorage.get.item(e);s&&"null"!==s?s.some(function(e){return r?e[r]===t[r]:e===t})||(s.unshift(t),s.splice(n||5)):s=[t],i.vm.$q.localStorage.set(e,s)}},s=function(t,e,r,n){if(t&&!(t.length<1)&&e){var s=i.vm.$q.localStorage.get.item(e);s&&"null"!==s?(t.forEach(function(t){s.some(function(e){return r?e[r]===t[r]:t===e})||s.unshift(t)}),s.splice(n||5)):s=t,i.vm.$q.localStorage.set(e,s)}};r.d(e,"b",function(){return o}),r.d(e,"a",function(){return a});var o=function(t){!function(t,e,r,i){t&&(t instanceof Array?s(t,e,r,i):n(t,e,r,i))}(t,"favorite_user_list","account")},a=function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,e=arguments[1],r=i.vm.$q.localStorage.get.item(e);return r&&"null"!==r?r.slice(0,t):[]}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,"favorite_user_list")}},oc7c:function(t,e,r){"use strict";var i=r("Cf0S"),n={props:{value:[Array]},computed:{empty:function(){return!this.value||0===this.value.length}},methods:{__select:function(t,e){var r=this,i=t?this.value.concat(e):this.value.filter(function(t){return!r.__is_same(t,e)});this.$emit("input",i)},__render_list_content:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options();return r&&r.length>0?r.map(function(r){return t("q-checkbox",{staticClass:"no-ripple ",props:{value:e.value&&e.value.some(function(t){return e.__is_same(t,r)}),falseValue:!1,trueValue:!0},on:{input:function(t){return e.__select(t,r)}}},[e.render_list_content(t,r)])}):this.__render_no_options(t)}}},s={data:function(){return{lazyQueryTimer:null,kw:"",filter_placeholder:"通过关键字查找",filter_icon:"search"}},watch:{kw:function(t){var e=this;this.lazyQueryTimer&&clearTimeout(this.lazyQueryTimer),this.lazyQueryTimer=setTimeout(function(){e.lazyQueryTimer=null,e.search(t)},300)}},methods:{render_list_top:function(t){var e=this;return t("q-input",{staticClass:"font-12 q-pl-xs q-pr-xs q-ml-xs q-mr-xs q-mt-xs pp pp-border-4 pp-radius-3 bg-grey-1",props:{value:this.kw,placeholder:this.filter_placeholder,hideUnderline:!0,before:[{icon:this.filter_icon}]},on:{input:function(t){return e.kw=t}}})},options:function(){return this.raw_options},__show:function(){this.kw="",this.raw_options=[],this.show()},show:function(){}}},o=r("uoZE"),a=r("obBT");e.a={mixins:[i.a,n,s],data:function(){return{favorite:[],distinctKey:"account"}},methods:{render_field_prefix:function(t,e){return this.$slots.before},render_field_content:function(t,e){var r=this;return e&&0!==e.length?t("div",{staticClass:"flex",style:{marginLeft:"-4px"}},this.value.map(function(e){return t("div",{staticClass:"flex no-wrap items-center q-mr-sm"},r.render_field_item(t,e))})):this.__render_placeholder(t)},render_field_item:function(t,e){var r=this;return[t("q-checkbox",{staticClass:"no-ripple",props:{value:!0,disable:this.disable},on:{input:function(t){return r.__select(t,e)}}}),t("span",{staticClass:"font-12"},e.name)]},render_list_content:function(t,e){return[t("div",{staticClass:"q-mr-xs font-12 text-no-wrap",style:{minWidth:"38px"}},e.name),t("span",{staticClass:"text-faded font-12"},e.account)]},show:function(){this.favorite=Object(a.a)(5)},__select:function(t,e){var r=this,i=t?this.value.concat(e):this.value.filter(function(t){return!r.__is_same(t,e)});this.$emit("input",i),t&&Object(a.b)(e)},__render_list:function(t){return t("q-list",{staticClass:"q-pt-xs q-pb-xs column no-border",props:{link:!0,dense:!0}},[this.kw?this.__render_list_content(t):this.render_list_favorite(t)])},render_list_favorite:function(t){return[t("q-list-header",{staticClass:"no-padding q-ml-xs",style:{fontSize:"12px",minHeight:"14px"}},"常用"),this.favorite&&this.favorite.length>0?this.__render_list_content(t,this.favorite):null]},search:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.kw;e&&Object(o.b)(e).then(function(e){1===e.status&&(t.raw_options=e.data)})}}}},"pO+f":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=(0,r("URu4").regex)("decimal",/^[-]?\d*(\.\d+)?$/);e.default=i},qHXR:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(t){return(0,i.withParams)({type:"maxLength",max:t},function(e){return!(0,i.req)(e)||(0,i.len)(e)<=t})}},qyJz:function(t,e,r){"use strict";var i=r("+ZMJ"),n=r("kM2E"),s=r("sB3e"),o=r("msXi"),a=r("Mhyx"),u=r("QRG4"),l=r("fBQ2"),c=r("3fs2");n(n.S+n.F*!r("dY0y")(function(t){Array.from(t)}),"Array",{from:function(t){var e,r,n,d,p=s(t),h="function"==typeof this?this:Array,f=arguments.length,_=f>1?arguments[1]:void 0,m=void 0!==_,g=0,b=c(p);if(m&&(_=i(_,f>2?arguments[2]:void 0,2)),void 0==b||h==Array&&a(b))for(r=new h(e=u(p.length));e>g;g++)l(r,g,m?_(p[g],g):p[g]);else for(d=b.call(p),r=new h;!(n=d.next()).done;g++)l(r,g,m?o(d,_,[n.value,g],!0):n.value);return r.length=g,r}})},tL8V:function(t,e,r){"use strict";(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.withParams=void 0;var i="undefined"!=typeof window?window:void 0!==t?t:{},n=i.vuelidate?i.vuelidate.withParams:function(t,e){return"object"===r(t)&&void 0!==e?e:t(function(){})};e.withParams=n}).call(e,r("DuR2"))},xJ3U:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r("URu4");e.default=function(t){return(0,i.withParams)({type:"maxValue",max:t},function(e){return!(0,i.req)(e)||(!/\s/.test(e)||e instanceof Date)&&+e<=+t})}}});
//# sourceMappingURL=4.cd83619a6b427be7d142.js.map